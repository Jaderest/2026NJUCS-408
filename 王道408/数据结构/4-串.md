# 第四章 串

## 目录
- [第四章 串](#第四章-串)
  - [目录](#目录)
- [4.2 串的模式匹配](#42-串的模式匹配)
    - [部分匹配值PM](#部分匹配值pm)
    - [next数组含义及手算方法](#next数组含义及手算方法)
    - [next数组的优化？！](#next数组的优化)
    - [易错点](#易错点)

# 4.2 串的模式匹配

***注意，这里都假设串的编号从1开始，若串编号从0开始，则next数组整体减1***

### 部分匹配值PM

Partial Match, PM

| 编号 | 1（从1开始） | 2    | 3    | 4    | 5    |
| ---- | ------------ | ---- | ---- | ---- | ---- |
| S    | a            | b    | a    | b    | a    |
| PM   | 0            | 0    | 1    | 2    | 3    |

### next数组含义及手算方法

- next数组[j]
  - 模式串j个字符失配时，跳到（模式串的）next[j]位置继续比较
  - next[j]前的均已匹配上

- PM右移一位，整体加1
- 若串编号从0开始，则next整体减1

### next数组的优化？！

- 若j指向字符匹配失败，j=next[j]后指向的字符和原j**一样**呢？那么它也会失配！

  |       | a    | b    | a    | a    | b    | c    |
  | ----- | ---- | ---- | ---- | ---- | ---- | ---- |
  | next0 | n1   | n2   | n3   | n4   | n5   | n6   |
  |       | 0    | 1    | 1    | 2    | 2    | 3    |

  - j = 3，next[3]=1；发现j=3和j=1的字符相同，若3的a失配，那么1的a也会失配
  - 所以我们直接让n3 = n1 = 0，完成一点点优化
  - n5 = n2 = 1

- 接下来获得的即为nextval

  |              | a    | b    | a    | a    | b    | c    |
  | ------------ | ---- | ---- | ---- | ---- | ---- | ---- |
  | **nextval0** | n1   | n2   | n3   | n4   | n5   | n6   |
  |              | 0    | 1    | 0    | 2    | 1    | 3    |

### 易错点

- PM怎么求

  - 最基本的求法

  - 然后一种特殊情况，a<u>a</u>时，a=a，为1；aa<u>a</u>时，aa=a<u>a</u>，为2（反正不能包含自身）

    |      | a    | a    | a    | a    | b    |
    | ---- | ---- | ---- | ---- | ---- | ---- |
    | PM   | 0    | 1    | 2    | 3    | 0    |

- KMP中滑动距离
  - j - next[j]
  - j - nextval[j]